image: Visual Studio 2017
shallow_clone: true

install:
  
  #set python version, and cygwin tools for clang tests
  - "set PATH=%PYTHON%;%PYTHON%\\Scripts;C:\\cygwin64\\bin;C:\\msys64;%PATH%"
  - python --version
  - pip install lxml
  - pip install pypiwin32
  - choco install dmd
  - choco install ldc
  - choco install swig
  - choco install vswhere

environment:
  matrix:
    - PYTHON: "C:\\Python27"
      BUILD_JOB_NUM: 1
    - PYTHON: "C:\\Python27"
      BUILD_JOB_NUM: 2
    - PYTHON: "C:\\Python27"
      BUILD_JOB_NUM: 3
    - PYTHON: "C:\\Python27"
      BUILD_JOB_NUM: 4

    - PYTHON: "C:\\Python35"
      BUILD_JOB_NUM: 1
    - PYTHON: "C:\\Python35"
      BUILD_JOB_NUM: 2
    - PYTHON: "C:\\Python35"
      BUILD_JOB_NUM: 3
    - PYTHON: "C:\\Python35"
      BUILD_JOB_NUM: 4

    - PYTHON: "C:\\Python36"
      BUILD_JOB_NUM: 1
    - PYTHON: "C:\\Python36"
      BUILD_JOB_NUM: 2
    - PYTHON: "C:\\Python36"
      BUILD_JOB_NUM: 3
    - PYTHON: "C:\\Python36"
      BUILD_JOB_NUM: 4

    - PYTHON: "C:\\Python27-x64"
      BUILD_JOB_NUM: 1
    - PYTHON: "C:\\Python27-x64"
      BUILD_JOB_NUM: 2
    - PYTHON: "C:\\Python27-x64"
      BUILD_JOB_NUM: 3
    - PYTHON: "C:\\Python27-x64"
      BUILD_JOB_NUM: 4

    - PYTHON: "C:\\Python35-x64"
      BUILD_JOB_NUM: 1
    - PYTHON: "C:\\Python35-x64"
      BUILD_JOB_NUM: 2
    - PYTHON: "C:\\Python35-x64"
      BUILD_JOB_NUM: 3
    - PYTHON: "C:\\Python35-x64"
      BUILD_JOB_NUM: 4
      
    - PYTHON: "C:\\Python36-x64"
      BUILD_JOB_NUM: 1
    - PYTHON: "C:\\Python36-x64"
      BUILD_JOB_NUM: 2
    - PYTHON: "C:\\Python36-x64"
      BUILD_JOB_NUM: 3
    - PYTHON: "C:\\Python36-x64"
      BUILD_JOB_NUM: 4

build: off
build_script:
  - cmd: echo "src/engine/SCons/JobTests.py" > exclude_jobs.txt
  - cmd: python runtest.py -l -a --exclude-list exclude_jobs.txt > all_tests.txt 
  - cmd: powershell "./.appveyor/runtest.ps1"